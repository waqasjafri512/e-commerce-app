<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/css/orders.css">
</head>

<body>
    <%- include('../includes/navigation.ejs') %>
    <main>
        <% if (orders.length <= 0) { %>
            <h1>Nothing there!</h1>
        <% } else { %>
            <ul class="orders">
                <% orders.forEach(order => { %>
                    <li class="orders__item">

                        <!-- ORDER HEADING + INVOICE LINK -->
                        <h1>
                            Order - # <%= order._id %>
                                     <a href="/orders/<%= order._id %>" 
                                         style="font-size: 16px; margin-left: 15px; color: purple;">
                                         Invoice
                                     </a>
                                     <a href="/orders/<%= order._id %>/checkout" 
                                         style="font-size: 16px; margin-left: 15px; color: green;">
                                         Pay
                                     </a>
                                     <span style="margin-left: 15px;">Status: <strong><%= order.status || 'Pending' %></strong></span>
                        </h1>

                        <% if (order.trackingHistory && order.trackingHistory.length) { %><p>Tracking: <%= order.trackingHistory.map(t => t.status).join(' â†’ ') %></p><% } %>
                        <!-- PRODUCT LIST -->
                        <ul class="orders__products">
                            <% order.products.forEach(p => { %>
                                <li class="orders__products-item">
                                    <%= p.product.title %> (<%= p.quantity %>)
                                </li>
                            <% }); %>
                        </ul>

                    </li>
                <% }); %>
            </ul>
        <% } %>
    </main>
    <%- include('../includes/end.ejs') %>
</body>
